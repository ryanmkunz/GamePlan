
@{
    ViewBag.Title = "Weather";
}

<h2>Weather</h2>
<html>
<head>
    <link href="https://www.googleapis.com/geolocation/v1/geolocate?key=AIzaSyAJv-wrcl6nN6ENIOTnRwAtMzTGhjQDj4w"/>
    <script src="~/Scripts/jquery-3.3.1.js"></script>

<style>
    #list li {
        list-style-type: none;
    }
    #list lr {
        padding: 15px;
    }
    .badge {
        padding: 25px;
        
    }
</style>

</head>
<body>

    <button id="getWeather" onclick="getWeather()">Get Current Weather!</button>
    <ul id="list">
        <lr class="badge">
            <li><p id="weekDay1"></p></li>
            <li><p id="summaryDay1"></p></li>
            <li><p id="tempDay1"></p></li>
        </lr>
        <lr class="badge">
            <li><p id="weekDay2"></p></li>
            <li><p id="summaryDay2"></p></li>
            <li><p id="tempDay2"></p></li>
        </lr>
        <lr class="badge">
            <li><p id="weekDay3"></p></li>
            <li><p id="summaryDay3"></p></li>
            <li><p id="tempDay3"></p></li>
        </lr>
        <lr class="badge">
            <li><p id="weekDay4"></p></li>
            <li><p id="summaryDay4"></p></li>
            <li><p id="tempDay4"></p></li>
        </lr>
        <lr class="badge">
            <li><p id="weekDay5"></p></li>
            <li><p id="summaryDay5"></p></li>
            <li><p id="tempDay5"></p></li>
        </lr>
        <lr class="badge">
            <li><p id="weekDay6"></p></li>
            <li><p id="summaryDay6"></p></li>
            <li><p id="tempDay6"></p></li>
        </lr>
        <lr class="badge">
            <li><p id="weekDay7"></p></li>
            <li><p id="summaryDay7"></p></li>
            <li><p id="tempDay7"></p></li>
        </lr>

    </ul>
    @Html.ActionLink("Get recommendations", "Recommended", "Events", new { currentTemp = 65 }, null)

    <script type="text/javascript">
        var getWeather = function () {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function (position) {
                    var lat = position.coords.latitude;
                    var long = position.coords.longitude;
                    showWeather(lat, long)
                })
            }
            else {
                window.alert("Could not get location");
            }
        }

        function showWeather(lat, long) {
            var url = `https://api.darksky.net/forecast/f672ff13193bfcc40427a678ebfdbc71/${lat},${long}` + `?format=jsonp&callback=displayWeather`;
            var script = document.createElement("script");
            script.type = "text/javascript";
            script.src = url;
            document.getElementsByTagName("head")[0].appendChild(script);
            displayWeather(object)
        }

        function displayWeather(object) {
            var weekDay1 = "@System.DateTime.Today.DayOfWeek.ToString()";
            var weekDay2 = "@System.DateTime.Today.AddDays(1).DayOfWeek.ToString()";
            var weekDay3 = "@System.DateTime.Today.AddDays(2).DayOfWeek.ToString()";
            var weekDay4 = "@System.DateTime.Today.AddDays(3).DayOfWeek.ToString()";
            var weekDay5 = "@System.DateTime.Today.AddDays(4).DayOfWeek.ToString()";
            var weekDay6 = "@System.DateTime.Today.AddDays(5).DayOfWeek.ToString()";
            var weekDay7 = "@System.DateTime.Today.AddDays(6).DayOfWeek.ToString()";
            $("#weekDay1").append(weekDay1);
            $("#weekDay2").append(weekDay2);
            $("#weekDay3").append(weekDay3);
            $("#weekDay4").append(weekDay4);
            $("#weekDay5").append(weekDay5);
            $("#weekDay6").append(weekDay6);
            $("#weekDay7").append(weekDay7);

            for (var i = 1; i <= 7; i++) {                
                $("#summaryDay" + i + "").append(object.daily.data[i].icon);
                $("#tempDay" + i + "").append("  HighTemp: " + Math.round(object.daily.data[i].temperatureHigh,0) + " degrees F");
            }
        }

    </script>
</body>
</html>
